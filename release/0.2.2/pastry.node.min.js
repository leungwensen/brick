!function(a){"use strict";a=a||{};var b={},c=Array,d=Function,e=Object,f=String,g="prototype",h="undefined",i=c[g],j=d[g],k=e[g],l=f[g],m={}.toString,n=i.slice,o=function(){};b.VERSION="0.2.0",b.index=function(a){return function(b,c,d){var e,f=b.length>>>0;if(0===f)return-1;if(d?0>d&&(d=Math.max(0,b.length+d)):d=0,a){for(e=d;e<b.length;e++)if(b[e]===c)return e}else for(e=d;e>=0;e--)if(b[e]===c)return e;return-1}},b.indexOf=i.indexOf?function(a,b,c){return a.indexOf(b,c)}:b.index(!0),b.lastIndexOf=i.lastIndexOf?function(a,b,c){return a.lastIndexOf(b,c)}:b.index(),b.each=b.forEach=k.forEach?function(a,b,c){a.forEach(b,c)}:function(a,b,c){for(var d in a)b.call(c,a[d],d,a)},b.every=i.every?function(a,b,c){return a.every(b,c)}:function(a,b,c){var d;for(d=0;d<a.length;d++)if(!b.call(c,a[d],d,a))return!1;return!0},b.filter=i.filter?function(a,b,c){return a.filter(b,c)}:function(a,c,d){var e=[];return b.each(a,function(b,f){c.call(d,b,f,a)&&e.push(b)}),e},b.map=i.map?function(a,b,c){return a.map(b,c)}:function(a,c,d){var e=[];return b.each(a,function(b,f){e.push(c.call(d,b,f,a))}),e},b.some=i.some?function(a,b,c){return a.some(b,c)}:function(a,b,c){var d;for(d=0;d<a.length;d++)if(b.call(c,a[d],d,a))return!0;return!1},b.reduce=i.reduce?function(a,b,c){return c?a.reduce(b,c):a.reduce(b)}:function(a,b,c){var d,e;for(c&&(e=c),d=0;d<a.length;d++)e=e?b(e,a[d],d,a):a[d];return e},b.reduceRight=i.reduceRight?function(a,b,c){return c?a.reduceRight(b,c):a.reduceRight(b)}:function(a,b,c){var d,e;for(c&&(e=c),d=a.length-1;d>=0;d--)e=e?b(e,a[d],d,a):a[d];return e},b.trim=l.trim?function(a){return a.trim()}:function(a){return a.replace(/^\s+|\s+$/g,"")},b.trimLeft=l.trimLeft?function(a){return a.trimLeft()}:function(a){return a.replace(/^\s+/g,"")},b.trimRight=l.trimRight?function(a){return a.trimRight()}:function(a){return a.replace(/\s+$/g,"")},b.lc=function(a){return a.toString().toLowerCase()},b.uc=function(a){return a.toString().toUpperCase()},b.hasSubString=function(a,b){return a.indexOf(b)>-1},b.each(["Array","Arguments","Boolean","Date","Error","Function","Number","RegExp","String"],function(a){b["is"+a]=function(b){return m.call(b)==="[object "+a+"]"}}),b.isArray=c.isArray?c.isArray:b.isArray,b.isObject=function(a){var b=typeof a;return"object"===b&&!!a},b.isNaN=function(a){return b.isNumber(a)&&a!==+a},b.isFinite=function(a){return b.isNumber(a)&&isFinite(a)&&!isNaN(a)},b.isUndefined=function(a){return void 0===a},b.isNull=function(a){return null===a},b.toArray=function(a){return n.call(a)},b.merge=function(a){return b.isObject(a)&&b.each(b.toArray(arguments).slice(1),function(c){if(c)for(var d in c)b.isObject(c[d])?(a[d]=a[d]||{},b.merge(a[d],c[d])):a[d]=c[d]}),a},b.extend=function(a){return b.isObject(a)&&b.each(b.toArray(arguments).slice(1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},b.remove=function(a,c,d){var e,f=a.length;return b.isNumber(c)?(e=a.slice((d||c)+1||f),a.length=0>c?f+c:c,a.push.apply(a,e)):a},b.keys=e.keys?function(a){return e.keys(a)}:function(a){var c=[];return b.isFunction(a)?b.each(a,function(a,d){d!==b&&c.push(d)}):b.each(a,function(a,b){c.push(b)}),c},b.values=function(a){var c=[];return b.each(a,function(a){c.push(a)}),c},b.hasKey=function(a,b){return a.hasOwnProperty(b)},b.hasValue=function(a,c){return b.indexOf(b.values(a),c)>-1},b.uniq=function(a){var c=[];return b.each(a,function(a){b.hasValue(c,a)||c.push(a)}),c},b.union=function(){var a=[],c=b.toArray(arguments).slice();return b.each(c,function(b){a.concat(b)}),b.uniq(a)},b.bind=j.bind?function(a,c){return a.bind(c,b.toArray(arguments).slice(2))}:function(c,d){if(b.isFunction(d)&&b.isFunction(c)){var e=b.toArray(arguments).slice(2),f=function(){},g=function(){return c.apply(this instanceof f&&d?this:d||a,e.concat(arguments))};return f[b]=c[b],g[b]=new f,g}},b.each(["info","log","warn"],function(a){b[a.toUpperCase()]=typeof console===h?o:console[a]}),b.ERROR=function(a){throw b.warn(b.toArray(arguments)),new Error(a)},b.getAny=function(a){var b,c;for(b=0;b<a.length;b++)try{c=a[b]();break}catch(d){}return c},b.uuid=function(a){return a=a||"",a+"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8,d=c.toString(16);return d})},b.mixin=function(a,c){b.each(a,function(a,d){b[d]&&!c?b.ERROR("P."+d+" already exists"):b[d]=a})},b.setGLOBAL=function(b,c){typeof exports!==h?(typeof module!==h&&module.exports&&(module.exports=c),exports[b]=c):a[b]=c},b.each(["P","pastry","PASTRY"],function(a){b.setGLOBAL(a,b)}),b.getGLOBAL=function(b){return a[b]}}(this),function(a){"use strict";function b(b){b.apply(h,a.toArray(arguments).slice(1))}function c(b,c,d){k._post(function(a,b){b&&a&&(i[a]=b,f(a))},b,a.isFunction(d)?d.apply(h,c):d)}function d(a,b,c){if("require"===a)return function(a){return d(a,b)};var e;return c?e=i[a]:k._req(function(a){e=i[a]},a,b),e}function e(b,c){var d,e=c.length,f=function(a){return function(){a(),d()}};if(e)if(1===e)d=b;else{var g=e;d=function(){--g||b()}}else b();a.each(c,function(a){var b=j[a];b===!0?d():j[a]=a?f(b):d})}function f(a){var b=j[a];j[a]=!0,b&&b!==!0&&b()}function g(){var b=a.toArray(arguments).slice(),f=a.isString(b[0])?b.shift():h,g=b.length>1?b.shift():[],i=b[0];k._pre(function(b,f,g){e(function(){c(b,a.map(f,function(a){return d(a,b,1)}),g)},f)},f,g,i)}var h,i={},j={},k={_pre:b,_post:b,_req:b},l=g;g.amd={},g("pastry",a),g("amd",k),f("require"),a.setGLOBAL("define",g),a.setGLOBAL("require",l)}(this.pastry),define("fmt/date",[],function(){"use strict";function a(a){return 10>a?"0"+a:a}function b(a){var b=a+"",c=b.length;return 3===c?b:2===c?"0"+b:"00"+b}return function(c,d){var e=c.getFullYear()+"",f=c.getMonth()+1,g=c.getDate(),h=c.getHours(),i=c.getMinutes(),j=c.getSeconds(),k=c.getMilliseconds();return d=d||"{YYYY}-{MM}-{DD} {hh}:{mm}:{ss}",d.replace("{YYYY}",e).replace("{MM}",a(f)).replace("{DD}",a(g)).replace("{hh}",a(h)).replace("{mm}",a(i)).replace("{ss}",a(j)).replace("{lms}",b(k)).replace("{YY}",e.substring(2)).replace("{M}",f).replace("{D}",g).replace("{h}",h).replace("{m}",i).replace("{s}",j).replace("{ms}",k)}}),define("fmt/sprintf",["pastry"],function(a){"use strict";var b=/%(\+)?([0 ]|'(.))?(-)?([0-9]+)?(\.([0-9]+))?([%bcdfosxX])/g,c=function(c){a.isString(c)||a.ERROR("sprintf: The first arguments need to be a valid format string.");for(var d,e=[],f=1,g=a.toArray(arguments);d=b.exec(c);)f>=g.length&&"%"!==d[8]&&a.ERROR("sprintf: At least one argument was missing."),e[e.length]={begin:d.index,end:d.index+d[0].length,sign:"+"===d[1],negative:parseFloat(g[f])<0?!0:!1,padding:a.isUndefined(d[2])?" ":"'"===d[2].substring(0,1)?d[3]:d[2],alignLeft:"-"===d[4],width:a.isUndefined(d[5])?!1:d[5],precision:a.isUndefined(d[7])?!1:d[7],type:d[8],data:"%"!==d[8]?String(g[f++]):!1};var h,i,j,k,l="",m=0;for(h=0;h<e.length;h++){switch(l+=c.substring(m,e[h].begin),m=e[h].end,j="",e[h].type){case"%":j="%";break;case"b":j=Math.abs(parseInt(e[h].data)).toString(2);break;case"c":j=String.fromCharCode(Math.abs(parseInt(e[h].data)));break;case"d":j=String(Math.abs(parseInt(e[h].data)));break;case"f":j=e[h].precision===!1?String(Math.abs(parseFloat(e[h].data))):Math.abs(parseFloat(e[h].data)).toFixed(e[h].precision);break;case"o":j=Math.abs(parseInt(e[h].data)).toString(8);break;case"s":j=e[h].data.substring(0,e[h].precision?e[h].precision:e[h].data.length);break;case"x":j=Math.abs(parseInt(e[h].data)).toString(16).toLowerCase();break;case"X":j=Math.abs(parseInt(e[h].data)).toString(16).toUpperCase();break;default:a.ERROR('sprintf: Unknown type "'+e[h].type+'" detected. This should never happen. Maybe the regex is wrong.')}if("%"!==e[h].type){if(e[h].width!==!1&&e[h].width>j.length)for(k=j.length,i=0;i<e[h].width-k;++i)j=e[h].alignLeft===!0?j+e[h].padding:e[h].padding+j;("b"===e[h].type||"d"===e[h].type||"o"===e[h].type||"f"===e[h].type||"x"===e[h].type||"X"===e[h].type)&&(e[h].negative===!0?j="-"+j:e[h].sign===!0&&(j="+"+j)),l+=j}else l+=j}return l+=c.substring(m,c.length)};return a.mixin({sprintf:c}),c}),define("fmt/vsprintf",["pastry","fmt/sprintf"],function(a,b){"use strict";var c=function(a,c){return c.unshift(a),b.apply(null,c)};return a.mixin({vsprintf:c}),c}),define("shim/json",["pastry","fmt/date"],function(pastry,fmtDate){"use strict";function exportJSON(a){pastry.mixin({JSON:a}),pastry.setGLOBAL("JSON",a)}if(JSON&&JSON.parse&&JSON.stringify)return exportJSON(JSON),JSON;var D2JSON=Date.prototype.toJSON;pastry.isFunction(D2JSON)||(pastry.each([String.prototype,Number.prototype,Boolean.prototype],function(a){a.toJSON=function(){return this.valueOf()}}),D2JSON=function(){return isFinite(this.valueOf())?fmtDate(this,"{YYY}-{MM}-{DD}T{hh}:{mm}:{ss}Z"):null});var gap,indent,rep,cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},quote=function(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return pastry.isString(b)?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'},str=function(a,b){var c,d,e=gap,f=b[a];switch(f&&pastry.isFunction(f.toJSON)&&(f=f.toJSON(a)),pastry.isFunction(rep)&&(f=rep.call(b,a,f)),!0){case pastry.isString(f):return quote(f);case pastry.isNumber(f):return isFinite(f)?f+"":"null";case pastry.isObject(f):return f?(gap+=indent,d=[],pastry.isArray(f)?(pastry.each(f,function(a,b){d[b]=str(b,f)||"null"}),c=0===d.length?"[]":gap?"[\n"+gap+d.join(",\n"+gap)+"\n"+e+"]":"["+d.join(",")+"]",gap=e,c):(rep&&pastry.isObject(rep)?pastry.each(rep,function(a){pastry.isString(a)&&(c=str(a,f),c&&d.push(quote(a)+(gap?": ":":")+c))}):pastry.each(f,function(a,b){c=str(b,f),c&&d.push(quote(b)+(gap?": ":":")+c)}),c=0===d.length?"{}":gap?"{\n"+gap+d.join(",\n"+gap)+"\n"+e+"}":"{"+d.join(",")+"}",gap=e,c)):"null";default:return f+""}},shim={stringify:function(a,b,c){var d;if(gap="",indent="",rep=b,pastry.isNumber(c))for(d=0;c>d;d+=1)indent+=" ";else pastry.isString(c)&&(indent=c);return rep=b,!b||pastry.isFunction(b)||pastry.isObject(b)&&pastry.isNumber(b.length)||pastry.ERROR("JSON.stringify"),str("",{"":a})},parse:function(text,reviver){function walk(a,b){var c,d=a[b];return d&&pastry.isObject(d)&&pastry.each(d,function(a,b){c=walk(d,b),c?d[b]=c:delete d[b]}),reviver.call(a,b,d)}var j;return text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))?(j=eval("("+text+")"),pastry.isFunction(reviver)?walk({"":j},""):j):void pastry.ERROR("JSON.parse")}};return exportJSON(shim),shim});