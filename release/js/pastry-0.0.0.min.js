/* pastry v0.0.0
*  https://github.com/leungwensen/pastry
*  Copyright (c) 2013 cookers;  Licensed MIT */
"use strict";var PASTRY,PT;PASTRY=PT={},function(){PT.OVEN=PT.OVEN||this}(),function(a){var b=a.ori=a.origin=a.origin||{};b.tryAny=b.tryAny||function(a){var b,c,d;for(b=0;b<a.length;b++){c=a[b];try{d=c();break}catch(e){}}return d}}(PT),function(a){a.isDef=a.isDef||function(a){return"undefined"!=typeof a},a.isFunc=a.isFunc||function(a){return"function"==typeof a},a.isNum=a.isNum||function(a){return"number"==typeof a},a.isObj=a.isObj||function(a){return"object"==typeof a},a.isStr=a.isStr||function(a){return"string"==typeof a},a.isArr=a.isArr||Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}}(PT),function(a){var b=Object,c=b.prototype;c.has=c.hasKey=c.hasKey||c.hasOwnProperty,c.each=c.forEach=c.forEach||function(a,b){var c,d=this;for(c in d)d.has(c)&&a.call(b,d[c],c,d)},b.keys=b.keys||function(b){var c=[];return a.isFunc(b)?b.each(function(a,b){"prototype"!==b&&c.push(b)}):b.each(function(a,b){c.push(b)}),c},c.keys=c.keys||function(){return b.keys(this)},b.values=b.values||function(a){var b=[];return a.each(function(a){b.push(a)}),b},c.values=c.values||function(){return b.values(this)},c.hasVal=c.hasValue=c.hasValue||function(a){return this.values().indexOf(a)>-1}}(PT),function(a){var b=Array.prototype;b.indexOf=b.indexOf||function(b,c){var d,e=this,f=e.length>>>0;if(0===f)return-1;if(a.isDef(c)||(c=0),c>=f)return-1;for(d=c>=0?c:Math.max(f-Math.abs(c),0);f>d;d++)if(e.has(d)&&e[d]===b)return d;return-1},b.lastIndexOf=b.lastIndexOf||function(b,c){var d,e=this,f=e.length>>>0;if(0===f)return-1;for(a.isDef(c)||(c=f),d=c>=0?Math.min(c,f-1):f-Math.abs(c);d>=0;d--)if(e.has(d)&&e[d]===b)return d;return-1},b.every=b.every||function(a,b){var c,d=this;for(c=0;c<d.length;c++)if(d.has(c)&&!a.call(b,d[c],c,d))return!1;return!0},b.filter=b.filter||function(a,b){var c=this,d=[];return c.each(function(e,f){a.call(b,e,f,c)&&d.push(e)}),d},b.map=b.map||function(a,b){var c=this,d=[];return c.each(function(e,f){d.push(a.call(b,e,f,c))}),d},b.some=b.some||function(a,b){var c,d=this;for(c=0;c<d.length;c++)if(d.has(c)&&a.call(b,d[c],c,d))return!0;return!1},b.reduce=b.reduce||function(b,c){var d,e,f=this,g=!1;for(a.isDef(c)&&(e=c,g=!0),d=0;d<f.length;d++)f.has(d)&&(g?e=b(e,f[d],d,f):(e=f[d],g=!0));if(!g)throw new TypeError;return e},b.reduceRight=b.reduceRight||function(b,c){var d,e,f=this,g=!1;for(a.isDef(c)&&(e=c,g=!0),d=f.length-1;d>=0;d--)f.has(d)&&(g?e=b(e,f[d],d,f):(e=f[d],g=!0));if(!g)throw new TypeError;return e},b.binarySearch=b.binarySearch||function(a,b){for(var c=0,d=this,e=d.length,f=Math.floor(e/2);e!==f;)b(a,d[f])>0?c=f+1:e=f,f=Math.floor((c+e)/2);return f=0===f&&0!==b(a,d[f])?-1:f},b.remove=b.remove||function(b,c){var d,e=this,f=e.length;return a.isDef(b)?(d=e.slice((c||b)+1||f),e.length=0>b?f+b:b,e.push.apply(e,d),void 0):e},b.replace=b.replace||function(a,b){var c=this;c.each(function(d,e){d===a&&(c[e]=b)})},b.intersection=b.intersection||function(a){var b=this,c=[];return b.each(function(b){a.hasVal(b)&&!c.hasVal(b)&&c.push(b)}),c},b.complement=b.complement||function(a){var b=this,c=[];return b.each(function(b){a.hasVal(b)||c.hasVal(b)||c.push(b)}),c},b.union=b.union||function(a){return this.concat(a).uniq()},b.uniq=b.uniq||function(){var a=this,b=[];return a.each(function(a){b.hasVal(a)||b.push(a)}),b}}(PT),function(){var a=Number.prototype;a.stringf=a.stringf||function(a){var b,c,d,e=this.toString(),f=e.split(".");if(a=a||{comma:1,decimal:2,integer:5,zero:0},d=a.has("zero")&&a.zero>0?"0":" ",a.has("decimal")&&a.decimal>0)for(f[1]=f[1]||"",f[1]=f[1].slice(0,a.decimal),c=a.decimal-f[1].length,b=0;c>b;b++)f[1]+="0";if(a.has("integer")&&a.integer>0)for(c=a.integer-f[0].length,b=0;c>b;b++)f[0]=d+f[0];return a.has("comma")&&0!==a.comma&&(f[0]=f[0].replace(/\B(?=(\d{3})+(?!\d))/g,",")),""!==f[1]?f.join("."):f[0]}}(),function(){var a=Date.prototype,b=function(a){return 10>a?"0"+a:a};a.stringf=a.stringf||function(a){var c,d,e,f,g,h;return a=a||"{YYYY}-{MM}-{DD} {hh}:{mm}:{ss}",a.replace("{YYYY}",c=String(this.getFullYear())).replace("{MM}",b(d=this.getMonth())).replace("{DD}",b(e=this.getDate())).replace("{hh}",b(f=this.getHours())).replace("{mm}",b(g=this.getMinutes())).replace("{ss}",b(h=this.getSeconds())).replace("{YY}",c.substring(2)).replace("{M}",d).replace("{D}",e).replace("{h}",f).replace("{m}",g).replace("{s}",h)}}(),function(){var a=String,b=a.prototype;b.trim=b.trim||function(){return this.replace(/^\s+|\s+$/g,"")}}(),function(PT){if(PT.JSON=PT.JSON||PT.origin.tryAny([function(){return JSON},function(){return PT.GROUND.JSON}]),!PT.isDef(PT.JSON)){var D2JSON=Date.prototype.toJSON;PT.isFunc(D2JSON)||([String.prototype,Number.prototype,Boolean.prototype].each(function(a){a.toJSON=function(){return this.valueOf()}}),D2JSON=function(){return isFinite(this.valueOf())?this.stringf("{YYY}-{MM}-{DD}T{hh}:{mm}:{ss}Z"):null});var gap,indent,rep,J=PT.JSON,cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},quote=function(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return PT.isStr(b)?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'},str=function(a,b){var c,d,e,f,g=gap,h=b[a];switch(h&&PT.isObj(h)&&PT.isFunc(h.toJSON)&&(h=h.toJSON(a)),PT.isFunc(rep)&&(h=rep.call(b,a,h)),typeof h){case"string":return quote(h);case"number":return isFinite(h)?String(h):"null";case"boolean":case"null":return String(h);case"object":if(!h)return"null";if(gap+=indent,f=[],"[object Array]"===Object.prototype.toString.apply(h)){for(c=0;c<h.length;c+=1)f[c]=str(c,h)||"null";return e=0===f.length?"[]":gap?"[\n"+gap+f.join(",\n"+gap)+"\n"+g+"]":"["+f.join(",")+"]",gap=g,e}return rep&&PT.isObj(rep)?rep.each(function(a){PT.isStr(a)&&(d=a,e=str(d,h),e&&f.push(quote(d)+(gap?": ":":")+e))}):h.each(function(a,b){e=str(b,h),e&&f.push(quote(b)+(gap?": ":":")+e)}),e=0===f.length?"{}":gap?"{\n"+gap+f.join(",\n"+gap)+"\n"+g+"}":"{"+f.join(",")+"}",gap=g,e}};J.stringify=J.stringify||function(a,b,c){var d;if(gap="",indent="",rep=b,PT.isNum(c))for(d=0;c>d;d+=1)indent+=" ";else PT.isStr(c)&&(indent=c);if(rep=b,!(!b||PT.isFunc(b)||PT.isObj(b)&&PT.isNum(b.length)))throw new Error("JSON.stringify");return str("",{"":a})},J.parse=J.parse||function(text,reviver){function walk(a,b){var c,d=a[b];return d&&PT.isObj(d)&&d.each(function(a,b){c=walk(d,b),PT.isDef(c)?d[b]=c:delete d[b]}),reviver.call(a,b,d)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),PT.isFunc(reviver)?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}}(PT);