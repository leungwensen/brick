/* pastry v0.0.5
*  https://github.com/leungwensen/pastry
*  Copyright (c) 2013 cookers;  Licensed MIT */
"use strict";var PASTRY,PT,P;PASTRY=PT=P={},P.OVEN=P.ON=this,function(){P.A=Array,P.AP=P.A.prototype,P.B=Boolean,P.BP=P.B.prototype,P.D=Date,P.DP=P.D.prototype,P.F=Function,P.FP=P.F.prototype,P.N=Number,P.NP=P.N.prototype,P.O=Object,P.OP=P.O.prototype,P.S=String,P.SP=P.S.prototype,P.toStr=P.OP.toString,P.isBool=function(a){return"boolean"==typeof a},P.isDef=function(a){return"undefined"!=typeof a},P.isFunc=function(a){return"function"==typeof a},P.isNum=function(a){return"number"==typeof a},P.isStr=function(a){return"string"==typeof a},P.isObj=function(a){return null!==a&&"object"==typeof a},P.isArr=P.A.isArray||function(a){return"[object Array]"===P.toStr.call(a)},P.isDate=function(a){return"[object Date]"===P.toStr.call(a)},P.isRegExp=function(a){return"[object RegExp]"===P.toStr.call(a)},P.toInt=function(a,b){return parseInt(a,b||10)},P.tryAny=function(a){var b,c,d;for(b=0;b<a.length;b++){c=a[b];try{d=c();break}catch(e){}}return d},P.isDef(exports)?(P.isDef(module)&&module.exports&&(exports=module.exports=P),exports.PASTRY=exports.PT=P,P.NODEJS=1,P.ON.process=process):(P.ON.PASTRY=P.ON.PT=P,P.BROWSER=1)}(),function(a){var b=a.SP;b.trim=b.trim||function(){return this.replace(/^\s+|\s+$/g,"")},b.uc=b.toUpperCase,b.lc=b.toLowerCase,b.toInt=function(a){return parseInt(this,a||10)}}(PT),function(a){var b=a.DP,c=function(a){return 10>a?"0"+a:a};b.stringf=function(b){var d,e,f,g,h,i;return b=b||"{YYYY}-{MM}-{DD} {hh}:{mm}:{ss}",b.replace("{YYYY}",d=a.S(this.getFullYear())).replace("{MM}",c(e=this.getMonth())).replace("{DD}",c(f=this.getDate())).replace("{hh}",c(g=this.getHours())).replace("{mm}",c(h=this.getMinutes())).replace("{ss}",c(i=this.getSeconds())).replace("{YY}",d.substring(2)).replace("{M}",e).replace("{D}",f).replace("{h}",g).replace("{m}",h).replace("{s}",i)}}(PT),function(a){var b=a.O,c=a.OP;c.has=c.hasKey=c.hasOwnProperty,c.each=c.forEach=c.forEach||function(a,b){var c,d=this;for(c in d)d.has(c)&&a.call(b,d[c],c,d)},b.keys=b.keys||function(b){var c=[];return a.isFunc(b)?b.each(function(a,b){"prototype"!==b&&c.push(b)}):b.each(function(a,b){c.push(b)}),c},c.keys=function(){return b.keys(this)},b.values=function(a){var b=[];return a.each(function(a){b.push(a)}),b},c.values=function(){return b.values(this)},c.hasVal=c.hasValue=function(a){return this.values().indexOf(a)>-1},c.merge=function(a){var b={};return this.each(function(a,c){b[c]=a}),a.each(function(a,c){b[c]=a}),b}}(PT),function(a){var b=a.NP;b.stringf=function(a){var b,c,d,e=this.toString(),f=e.split(".");if(a=a||{comma:1,decimal:2,integer:5,zero:0},d=a.has("zero")&&a.zero>0?"0":" ",a.has("decimal")&&a.decimal>0)for(f[1]=f[1]||"",f[1]=f[1].slice(0,a.decimal),c=a.decimal-f[1].length,b=0;c>b;b++)f[1]+="0";if(a.has("integer")&&a.integer>0)for(c=a.integer-f[0].length,b=0;c>b;b++)f[0]=d+f[0];return a.has("comma")&&0!==a.comma&&(f[0]=f[0].replace(/\B(?=(\d{3})+(?!\d))/g,",")),""!==f[1]?f.join("."):f[0]}}(PT),function(a){var b=a.AP;b.indexOf=b.indexOf||function(b,c){var d,e=this,f=e.length>>>0;if(0===f)return-1;if(a.isDef(c)||(c=0),c>=f)return-1;for(d=c>=0?c:Math.max(f-Math.abs(c),0);f>d;d++)if(e.has(d)&&e[d]===b)return d;return-1},b.lastIndexOf=b.lastIndexOf||function(b,c){var d,e=this,f=e.length>>>0;if(0===f)return-1;for(a.isDef(c)||(c=f),d=c>=0?Math.min(c,f-1):f-Math.abs(c);d>=0;d--)if(e.has(d)&&e[d]===b)return d;return-1},b.every=b.every||function(a,b){var c,d=this;for(c=0;c<d.length;c++)if(d.has(c)&&!a.call(b,d[c],c,d))return!1;return!0},b.filter=b.filter||function(a,b){var c=this,d=[];return c.each(function(e,f){a.call(b,e,f,c)&&d.push(e)}),d},b.map=b.map||function(a,b){var c=this,d=[];return c.each(function(e,f){d.push(a.call(b,e,f,c))}),d},b.some=b.some||function(a,b){var c,d=this;for(c=0;c<d.length;c++)if(d.has(c)&&a.call(b,d[c],c,d))return!0;return!1},b.reduce=b.reduce||function(b,c){var d,e,f=this,g=!1;for(a.isDef(c)&&(e=c,g=!0),d=0;d<f.length;d++)f.has(d)&&(g?e=b(e,f[d],d,f):(e=f[d],g=!0));if(!g)throw new TypeError;return e},b.reduceRight=b.reduceRight||function(b,c){var d,e,f=this,g=!1;for(a.isDef(c)&&(e=c,g=!0),d=f.length-1;d>=0;d--)f.has(d)&&(g?e=b(e,f[d],d,f):(e=f[d],g=!0));if(!g)throw new TypeError;return e},b.binarySearch=function(a,b){for(var c=0,d=this,e=d.length,f=Math.floor(e/2);e!==f;)b(a,d[f])>0?c=f+1:e=f,f=Math.floor((c+e)/2);return f=0===f&&0!==b(a,d[f])?-1:f},b.remove=function(b,c){var d,e=this,f=e.length;return a.isDef(b)?(d=e.slice((c||b)+1||f),e.length=0>b?f+b:b,e.push.apply(e,d),void 0):e},b.replace=function(a,b){var c=this;c.each(function(d,e){d===a&&(c[e]=b)})},b.intersection=function(a){var b=this,c=[];return b.each(function(b){a.hasVal(b)&&!c.hasVal(b)&&c.push(b)}),c},b.complement=function(a){var b=this,c=[];return b.each(function(b){a.hasVal(b)||c.hasVal(b)||c.push(b)}),c},b.union=function(a){return this.concat(a).uniq()},b.uniq=function(){var a=this,b=[];return a.each(function(a){b.hasVal(a)||b.push(a)}),b}}(PT),function(PT){if(PT.JSON=PT.tryAny([function(){return JSON},function(){return PT.OVEN.JSON}]),!PT.isDef(PT.JSON)){var D2JSON=PT.DP.toJSON,S=PT.S;PT.isFunc(D2JSON)||([PT.SP,PT.NP,PT.BP].each(function(a){a.toJSON=function(){return this.valueOf()}}),D2JSON=function(){return isFinite(this.valueOf())?this.stringf("{YYY}-{MM}-{DD}T{hh}:{mm}:{ss}Z"):null});var gap,indent,rep,J=PT.JSON,cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},quote=function(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return PT.isStr(b)?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'},str=function(a,b){var c,d,e,f,g=gap,h=b[a];switch(h&&PT.isObj(h)&&PT.isFunc(h.toJSON)&&(h=h.toJSON(a)),PT.isFunc(rep)&&(h=rep.call(b,a,h)),typeof h){case"string":return quote(h);case"number":return isFinite(h)?S(h):"null";case"boolean":case"null":return S(h);case"object":if(!h)return"null";if(gap+=indent,f=[],"[object Array]"===PT.OP.toString.apply(h)){for(c=0;c<h.length;c+=1)f[c]=str(c,h)||"null";return e=0===f.length?"[]":gap?"[\n"+gap+f.join(",\n"+gap)+"\n"+g+"]":"["+f.join(",")+"]",gap=g,e}return rep&&PT.isObj(rep)?rep.each(function(a){PT.isStr(a)&&(d=a,e=str(d,h),e&&f.push(quote(d)+(gap?": ":":")+e))}):h.each(function(a,b){e=str(b,h),e&&f.push(quote(b)+(gap?": ":":")+e)}),e=0===f.length?"{}":gap?"{\n"+gap+f.join(",\n"+gap)+"\n"+g+"}":"{"+f.join(",")+"}",gap=g,e}};J.stringify=function(a,b,c){var d;if(gap="",indent="",rep=b,PT.isNum(c))for(d=0;c>d;d+=1)indent+=" ";else PT.isStr(c)&&(indent=c);if(rep=b,!(!b||PT.isFunc(b)||PT.isObj(b)&&PT.isNum(b.length)))throw new Error("JSON.stringify");return str("",{"":a})},J.parse=function(text,reviver){function walk(a,b){var c,d=a[b];return d&&PT.isObj(d)&&d.each(function(a,b){c=walk(d,b),PT.isDef(c)?d[b]=c:delete d[b]}),reviver.call(a,b,d)}var j;if(text=S(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),PT.isFunc(reviver)?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}}(PT),function(a){function b(b,c,d){b[c]=a.toInt(d)}function c(a,c,e){d=c.match(e),d&&b(a,d[0].match(/\w*/)[0],d[1]||0)}var d,e=a.ON,f=e.process||{},g=e.navigator||{},h=g.platform,i=g.plugins,j=g.userAgent;a.initUA=function(){a.NODEJS?a.VER=a.versions=f.versions:(a.HOST=e.location.host,a.DOC=e.document,a.UA=a.userAgent=j,a.PL=a.platform=a.detectPL(h),a.PLUG=a.plugins=a.detectPLUG(i),a.VER=a.versions=a.detectVER(j))},a.detectPL=function(b){return a.isDef(b)?b.lc().match(/mac|windows|linux|ipad|ipod|iphone|android/)[0]||"unknown":void 0},a.detectPLUG=function(b){return{flash:function(){var c,d=0,e=13;if(b&&b.length)c=b["Shockwave Flash"],c&&c.description&&(d=c.description.match(/\b(\d+)\.\d+\b/)[1]||d);else for(;e--;)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+e),d=e;break}catch(f){}return a.toInt(d)}()}},a.detectVER=function(e){if(a.isDef(e)){e=e.lc();var f,g={};if([/msie ([\d.]+)/,/firefox\/([\d.]+)/,/chrome\/([\d.]+)/,/crios\/([\d.]+)/,/opera.([\d.]+)/,/adobeair\/([\d.]+)/].each(function(a){c(g,e,a)}),g.crios&&(g.chrome=g.crios),d=e.match(/version\/([\d.]+).*safari/),d&&b(g,"safari",d[1]||0),d=e.match(/version\/([\d.]+).*mobile.*safari/),d&&b(g,"mobilesafari",d[1]||0),[/trident\/([\d.]+)/,/gecko\/([\d.]+)/,/applewebkit\/([\d.]+)/,/presto\/([\d.]+)/].each(function(a){c(g,e,a)}),f=g.msie)switch(!0){case 6===f:g.trident=4;break;case 7===f||8===f:g.trident=5}return g}},a.initUA()}(PT);