/* brick v0.0.0
*  https://github.com/leungwensen/brick
*  Copyright (c) 2013 BR builders;  Licensed MIT */
"use strict";var BRICK,BR;BRICK=BR={},function(){BR.GROUND=BR.GROUND||this}(),function(a){a.origin=a.origin||{},a.origin.tryOneOf=a.origin.tryOneOf||function(a){var b,c,d;for(b=0;b<a.length;b++){c=a[b];try{d=c();break}catch(e){}}return d}}(BR),function(a){a.isDefined=a.isDefined||function(a){return"undefined"!=typeof a},a.isUndefined=a.isUndefined||function(a){return"undefined"==typeof a},a.isFunction=a.isFunction||function(a){return"function"==typeof a},a.isNumber=a.isNumber||function(a){return"number"==typeof a},a.isObject=a.isObject||function(a){return"object"==typeof a},a.isString=a.isString||function(a){return"string"==typeof a},a.isArray=a.isArray||Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}}(BR),function(a){a.array=a.array||Array,a.array.prototype.indexOf=a.array.prototype.indexOf||function(b,c){var d,e=this.length>>>0;if(0===e)return-1;if(a.isUndefined(c)&&(c=0),c>=e)return-1;for(d=c>=0?c:Math.max(e-Math.abs(c),0);e>d;d++)if(this.hasOwnProperty(d)&&this[d]===b)return d;return-1},a.array.prototype.lastIndexOf=a.array.prototype.lastIndexOf||function(b,c){var d,e=this.length>>>0;if(0===e)return-1;for(a.isUndefined(c)&&(c=e),d=c>=0?Math.min(c,e-1):e-Math.abs(c);d>=0;d--)if(this.hasOwnProperty(d)&&this[d]===b)return d;return-1},a.array.prototype.every=a.array.prototype.every||function(a,b){var c,d=this.length>>>0;for(c=0;d>c;c++)if(this.hasOwnProperty(c)&&!a.call(b,this[c],c,this))return!1;return!0},a.array.prototype.filter=a.array.prototype.filter||function(a,b){var c,d=[];this.length>>>0;for(c in this)this.hasOwnProperty(c)&&a.call(b,this[c],c,this)&&d.push(this[c]);return d},a.array.prototype.forEach=a.array.prototype.forEach||function(a,b){var c,d=this.length>>>0;for(c=0;d>c;c++)this.hasOwnProperty(c)&&a.call(b,this[c],c,this)},a.array.prototype.each=a.array.prototype.each||a.array.prototype.forEach,a.array.prototype.map=a.array.prototype.map||function(a,b){var c,d=[],e=this.length>>>0;for(c=0;e>c;c++)this.hasOwnProperty(c)&&d.push(a.call(b,this[c],c,this));return d},a.array.prototype.some=a.array.prototype.some||function(a,b){var c,d=this.length>>>0;for(c=0;d>c;c++)if(this.hasOwnProperty(c)&&a.call(b,this[c],c,this))return!0;return!1},a.array.prototype.reduce=a.array.prototype.reduce||function(a,b){var c,d,e=this.length>>>0,f=!1;for(null!==b&&(d=b,f=!0),c=0;e>c;c++)this.hasOwnProperty(c)&&(f?d=a(d,this[c],c,this):(d=this[c],f=!0));if(!f)throw new TypeError;return d},a.array.prototype.reduceRight=a.array.prototype.reduceRight||function(a,b){var c,d,e=this.length>>>0,f=!1;for(null!==b&&(d=b,f=!0),c=e-1;c>-1;c--)this.hasOwnProperty(c)||(f?d=a(d,this[c],c,this):(d=this[c],f=!0));if(!f)throw new TypeError;return d},a.array.prototype.binarySearch=a.array.prototype.binarySearch||function(a,b){for(var c=0,d=this.length,e=Math.floor(this.length/2);d!==e;)b(a,this[e])>0?c=e+1:d=e,e=Math.floor((c+d)/2);return e=0===e&&0!==b(a,this[e])?-1:e},a.array.prototype.remove=a.array.prototype.remove||function(b,c){if(a.isUndefined(b))return this;var d=this.slice((c||b)+1||this.length);this.length=0>b?this.length+b:b,this.push.apply(this,d)},a.array.prototype.replace=a.array.prototype.replace||function(a,b){var c,d=this.length>>>0;for(c=0;d>c;c++)this[c]===a&&(this[c]=b)},a.array.prototype.hasElement=a.array.prototype.hasElement||function(a){return this.indexOf(a)>-1},a.array.prototype.intersection=a.array.prototype.intersection||function(a){var b,c=this.length>>>0,d=[];for(b=0;c>b;b++)a.hasElement(this[b])&&!d.hasElement(this[b])&&d.push(this[b]);return d},a.array.prototype.complement=a.array.prototype.complement||function(a){var b,c=this.length>>>0,d=[];for(b=0;c>b;b++)a.hasElement(this[b])||d.hasElement(this[b])||d.push(this[b]);return d},a.array.prototype.union=a.array.prototype.union||function(a){return this.concat(a).uniq()},a.array.prototype.uniq=a.array.prototype.uniq||function(){var a=0,b=this.length>>>0,c=[];for(a=0;b>a;a++)c.hasElement(this[a])||c.push(this[a]);return c}}(BR),function(a){a.bool=a.bool||Boolean}(BR),function(a){a.number=a.number||Number,a.number.prototype.toFormatString=a.number.prototype.toFormatString||function(a){var b,c,d,e=this.toString(),f=e.split(".");if(a=a||{comma:1,decimal:2,integer:5,zero:0},d=a.hasOwnProperty("zero")&&a.zero>0?"0":" ",a.hasOwnProperty("decimal")&&a.decimal>0)for(f[1]=f[1]||"",f[1]=f[1].slice(0,a.decimal),c=a.decimal-f[1].length,b=0;c>b;b++)f[1]+="0";if(a.hasOwnProperty("integer")&&a.integer>0)for(c=a.integer-f[0].length,b=0;c>b;b++)f[0]=d+f[0];return a.hasOwnProperty("comma")&&0!==a.comma&&(f[0]=f[0].replace(/\B(?=(\d{3})+(?!\d))/g,",")),""!==f[1]?f.join("."):f[0]}}(BR),function(a){a.date=a.date||Date;var b=function(a){return(10>a?"0":"")+a};a.date.prototype.toFormatString=a.date.prototype.toFormatString||function(a){var c,d,e,f,g,h;return a=a||"{YYYY}-{MM}-{DD} {hh}:{mm}:{ss}",a.replace("{YYYY}",c=String(this.getFullYear())).replace("{MM}",b(d=this.getMonth())).replace("{DD}",b(e=this.getDate())).replace("{hh}",b(f=this.getHours())).replace("{mm}",b(g=this.getMinutes())).replace("{ss}",b(h=this.getSeconds())).replace("{YY}",c.substring(2)).replace("{M}",d).replace("{D}",e).replace("{h}",f).replace("{m}",g).replace("{s}",h)}}(BR),function(a){a.string=a.string||String,a.string.prototype.trim=a.string.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")}}(BR),function(a){a.object=a.object||Object,a.object.prototype.forEach=a.object.prototype.forEach||function(a,b){var c;for(c in this)this.hasOwnProperty(c)&&a.call(b,this[c],c,this)},a.object.prototype.each=a.object.prototype.each||a.object.prototype.forEach,a.object.keys=a.object.keys||function(b){var c,d=[];if(a.isFunction(b))for(c in b)b.hasOwnProperty(c)&&"prototype"!==c&&d.push(c);else for(c in b)b.hasOwnProperty(c)&&d.push(c);return d},a.object.prototype.keys=a.object.prototype.keys||function(){return Object.keys(this)},a.object.values=a.object.values||function(b){var c,d=a.object.keys(b),e=d.length,f=[];for(c=0;e>c;c++)f.push(b[d[c]]);return f},a.object.prototype.values=a.object.prototype.values||function(){return Object.values(this)},a.object.prototype.hasKey=a.object.prototype.hasKey||function(a){return this.hasOwnProperty(a)},a.object.prototype.hasValue=a.object.prototype.hasValue||function(a){return this.values().indexOf(a)>-1}}(BR),function(BR){BR.JSON=BR.JSON||{};var _originJSON=BR.origin.tryOneOf([function(){return JSON},function(){return BR.GROUND.JSON}]);if(BR.isDefined(_originJSON))return BR.JSON=_originJSON,void 0;var gap,indent,rep,cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},_toJSON=function(){return this.valueOf()},quote=function(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return BR.isString(b)?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'},str=function(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&BR.isObject(i)&&BR.isFunction(i.toJSON)&&(i=i.toJSON(a)),BR.isFunction(rep)&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&BR.isObject(rep))for(f=rep.length,c=0;f>c;c+=1)BR.isString(rep[c])&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}};String.prototype.toJSON=String.prototype.toJSON||_toJSON,Number.prototype.toJSON=Number.prototype.toJSON||_toJSON,Boolean.prototype.toJSON=Boolean.prototype.toJSON||_toJSON,Date.prototype.toJSON=Date.prototype.toJSON||function(){return isFinite(this.valueOf())?this.toFormatString("{YYY}-{MM}-{DD}T{hh}:{mm}:{ss}Z"):null},BR.JSON.stringify=BR.JSON.stringify||function(a,b,c){var d;if(gap="",indent="",rep=b,BR.isNumber(c))for(d=0;c>d;d+=1)indent+=" ";else BR.isString(c)&&(indent=c);if(!(!b||BR.isFunction(b)||BR.isObject(b)&&BR.isNumber(b.length)))throw new Error("JSON.stringify");return str("",{"":a})},BR.JSON.parse=BR.JSON.parse||function(text,reviver){var j,walk=function(a,b){var c,d,e=a[b];if(e&&BR.isObject(e))for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)};if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),BR.isFunction(reviver)?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}(BR);